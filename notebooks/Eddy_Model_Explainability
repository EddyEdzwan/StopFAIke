{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "576cf024",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2021-10-01 11:22:20.644063: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory\n",
      "2021-10-01 11:22:20.644135: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.\n",
      "[nltk_data] Downloading package punkt to /home/eddyedzwan/nltk_data...\n",
      "[nltk_data]   Package punkt is already up-to-date!\n",
      "[nltk_data] Downloading package stopwords to\n",
      "[nltk_data]     /home/eddyedzwan/nltk_data...\n",
      "[nltk_data]   Package stopwords is already up-to-date!\n",
      "[nltk_data] Downloading package wordnet to\n",
      "[nltk_data]     /home/eddyedzwan/nltk_data...\n",
      "[nltk_data]   Package wordnet is already up-to-date!\n"
     ]
    }
   ],
   "source": [
    "from StopFAIke import predict, preprocessor\n",
    "import tensorflow as tf\n",
    "import tensorflow_hub as hub\n",
    "import numpy as np\n",
    "import scipy as sp\n",
    "import shap\n",
    "import pandas as pd\n",
    "\n",
    "from transformers import AutoTokenizer"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "74ef2862",
   "metadata": {},
   "source": [
    "# Load Models for Explainability"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d92353f2",
   "metadata": {},
   "source": [
    "## Pre-trained Tokenizer"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "275641b2",
   "metadata": {},
   "outputs": [],
   "source": [
    "model_name = \"bert-base-uncased\"\n",
    "bert_tokenizer_pretrained = AutoTokenizer.from_pretrained(model_name)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8d9cd11e",
   "metadata": {},
   "source": [
    "## Custom Model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "c4c5903e",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2021-10-01 11:27:12.832018: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory\n",
      "2021-10-01 11:27:12.832982: W tensorflow/stream_executor/cuda/cuda_driver.cc:269] failed call to cuInit: UNKNOWN ERROR (303)\n",
      "2021-10-01 11:27:12.833830: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (DESKTOP-6JCUE35): /proc/driver/nvidia/version does not exist\n",
      "2021-10-01 11:27:12.845893: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA\n",
      "To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.\n",
      "2021-10-01 11:27:42.843997: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:185] None of the MLIR Optimization Passes are enabled (registered 2)\n"
     ]
    }
   ],
   "source": [
    "keras_load_reloaded_model = predict.get_model_from_gcp(local=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "a057fa22",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model: \"model_2\"\n",
      "__________________________________________________________________________________________________\n",
      "Layer (type)                    Output Shape         Param #     Connected to                     \n",
      "==================================================================================================\n",
      "text (InputLayer)               [(None,)]            0                                            \n",
      "__________________________________________________________________________________________________\n",
      "model_1 (Functional)            {'input_type_ids': ( 0           text[0][0]                       \n",
      "__________________________________________________________________________________________________\n",
      "prediction (Classifier)         (None, 1)            109580802   model_1[0][0]                    \n",
      "                                                                 model_1[0][1]                    \n",
      "                                                                 model_1[0][2]                    \n",
      "==================================================================================================\n",
      "Total params: 109,580,802\n",
      "Trainable params: 109,580,801\n",
      "Non-trainable params: 1\n",
      "__________________________________________________________________________________________________\n"
     ]
    }
   ],
   "source": [
    "keras_load_reloaded_model.summary()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 77,
   "id": "933c0f4f",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<tf.Tensor: shape=(1, 1), dtype=float32, numpy=array([[0.9982225]], dtype=float32)>"
      ]
     },
     "execution_count": 77,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "keras_load_reloaded_model.layers[2](keras_load_reloaded_model.layers[1](tf.constant(['this is covid during summer'])))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "7ed827a9",
   "metadata": {},
   "source": [
    "# Model Explainability"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "ff8bb03a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#Creating custom function for shap.Explainer\n",
    "def f(x):\n",
    "    '''\n",
    "    Returns the class probabilities output by the custom BERT classifier - two classes  \n",
    "    '''\n",
    "    # Calculate the class probabilities and stack them for each input sentence\n",
    "    prob_class_0, prob_class_1 = 1 - keras_load_reloaded_model(tf.constant(x)), keras_load_reloaded_model(tf.constant(x))\n",
    "    stacked_probabilities = np.hstack((prob_class_0, prob_class_1))\n",
    "    \n",
    "    # Calculate the logit values, change return value if choosing to explain via logits instead \n",
    "    # val = sp.special.logit(stacked_probabilities)\n",
    "    \n",
    "    return stacked_probabilities"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "e7873a0d",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([[0.99658775, 0.0034121 ]], dtype=float32)"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "f(['test text'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "a85ce2fd",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "  0%|          | 0/12 [00:00<?, ?it/s]"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Partition explainer: 2it [00:20, 20.68s/it]                                                                             \n"
     ]
    }
   ],
   "source": [
    "# build an explainer using a token masker\n",
    "explainer = shap.Explainer(f, masker=bert_tokenizer_pretrained, output_names=['TRUE', 'FAKE'])\n",
    "\n",
    "# Obtain shap_value for sample data\n",
    "random_test_sample = pd.Series(['test text'])\n",
    "shap_values = explainer(random_test_sample)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "f0445da0",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       ".values =\n",
       "array([[[ 7.30156898e-07, -5.28991222e-07],\n",
       "        [ 3.52625132e-01, -3.52624986e-01],\n",
       "        [ 2.51440719e-01, -2.51440663e-01],\n",
       "        [-2.98023224e-08,  1.11758709e-06]]])\n",
       "\n",
       ".base_values =\n",
       "array([[0.39252132, 0.60747719]])\n",
       "\n",
       ".data =\n",
       "array([['', 'test ', 'text', '']], dtype='<U5')"
      ]
     },
     "execution_count": 19,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "shap_values"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "id": "bd762b0e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "numpy.float64"
      ]
     },
     "execution_count": 29,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "type(shap_values.base_values[0, 1])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "id": "89fe94ba",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "['TRUE', 'FAKE']"
      ]
     },
     "execution_count": 37,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "shap_values.output_names"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "id": "ab0dbbf3",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "shap._explanation.Explanation"
      ]
     },
     "execution_count": 38,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "type(shap_values)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "id": "d11dfa45",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Create Custom SHAP Object inhereting from Explanation class (of a typical shap value) in order for plot to work\n",
    "class CustomSHAPObject(shap._explanation.Explanation):\n",
    "    def __init__(self, values, base_values, data, output_names):\n",
    "        super().__init__(values)\n",
    "        self.values = np.array(values)\n",
    "        self.base_values = base_values\n",
    "        self.data = np.array(data)\n",
    "        self.output_names = output_names"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "id": "837ee45e",
   "metadata": {},
   "outputs": [],
   "source": [
    "test_custom_object = CustomSHAPObject(list(shap_values.values[0, :, 0]),\n",
    "                                      float(shap_values.base_values[0, 0]),\n",
    "                                      list(shap_values.data[0]),\n",
    "                                      'TRUE')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "id": "01c984ee",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<svg width=\"100%\" height=\"80px\"><line x1=\"0\" y1=\"33\" x2=\"100%\" y2=\"33\" style=\"stroke:rgb(150,150,150);stroke-width:1\" /><line x1=\"8.333337%\" y1=\"33\" x2=\"8.333337%\" y2=\"37\" style=\"stroke:rgb(150,150,150);stroke-width:1\" /><text x=\"8.333337%\" y=\"27\" font-size=\"12px\" fill=\"rgb(120,120,120)\" dominant-baseline=\"bottom\" text-anchor=\"middle\">0.392521</text><text x=\"8.333337%\" y=\"10\" font-size=\"12px\" fill=\"rgb(120,120,120)\" dominant-baseline=\"bottom\" text-anchor=\"middle\">base value</text><line x1=\"22.619052%\" y1=\"33\" x2=\"22.619052%\" y2=\"37\" style=\"stroke:rgb(150,150,150);stroke-width:1\" /><text x=\"22.619052%\" y=\"27\" font-size=\"12px\" fill=\"rgb(120,120,120)\" dominant-baseline=\"bottom\" text-anchor=\"middle\">0.496076</text><line x1=\"36.904766%\" y1=\"33\" x2=\"36.904766%\" y2=\"37\" style=\"stroke:rgb(150,150,150);stroke-width:1\" /><text x=\"36.904766%\" y=\"27\" font-size=\"12px\" fill=\"rgb(120,120,120)\" dominant-baseline=\"bottom\" text-anchor=\"middle\">0.599630</text><line x1=\"51.190480%\" y1=\"33\" x2=\"51.190480%\" y2=\"37\" style=\"stroke:rgb(150,150,150);stroke-width:1\" /><text x=\"51.190480%\" y=\"27\" font-size=\"12px\" fill=\"rgb(120,120,120)\" dominant-baseline=\"bottom\" text-anchor=\"middle\">0.703184</text><line x1=\"65.476195%\" y1=\"33\" x2=\"65.476195%\" y2=\"37\" style=\"stroke:rgb(150,150,150);stroke-width:1\" /><text x=\"65.476195%\" y=\"27\" font-size=\"12px\" fill=\"rgb(120,120,120)\" dominant-baseline=\"bottom\" text-anchor=\"middle\">0.806738</text><line x1=\"79.761909%\" y1=\"33\" x2=\"79.761909%\" y2=\"37\" style=\"stroke:rgb(150,150,150);stroke-width:1\" /><text x=\"79.761909%\" y=\"27\" font-size=\"12px\" fill=\"rgb(120,120,120)\" dominant-baseline=\"bottom\" text-anchor=\"middle\">0.910293</text><line x1=\"91.666663%\" y1=\"33\" x2=\"91.666663%\" y2=\"37\" style=\"stroke:rgb(150,150,150);stroke-width:1\" /><text x=\"91.666663%\" y=\"27\" font-size=\"13px\" style=\"stroke:#ffffff;stroke-width:8px;\" font-weight=\"bold\" fill=\"rgb(255,255,255)\" dominant-baseline=\"bottom\" text-anchor=\"middle\">0.996588</text><text x=\"91.666663%\" y=\"27\" font-size=\"13px\" font-weight=\"bold\" fill=\"rgb(0,0,0)\" dominant-baseline=\"bottom\" text-anchor=\"middle\">0.996588</text><text x=\"91.666663%\" y=\"10\" font-size=\"12px\" fill=\"rgb(120,120,120)\" dominant-baseline=\"bottom\" text-anchor=\"middle\">f(x)</text><rect x=\"8.33333333333333%\" width=\"83.33332922198728%\" y=\"40\" height=\"18\" style=\"fill:rgb(255.0, 0.0, 81.08083606031792); stroke-width:0; stroke:rgb(0,0,0)\" /><line x1=\"43.02065707992864%\" x2=\"91.66666255532061%\" y1=\"60\" y2=\"60\" id=\"_fb_bciuudcooikaigouvfhx_ind_1\" style=\"stroke:rgb(255.0, 0.0, 81.08083606031792);stroke-width:2; opacity: 0\"/><text x=\"67.34365981762463%\" y=\"71\" font-size=\"12px\" id=\"_fs_bciuudcooikaigouvfhx_ind_1\" fill=\"rgb(255.0, 0.0, 81.08083606031792)\" style=\"opacity: 0\" dominant-baseline=\"middle\" text-anchor=\"middle\">0.353</text><svg x=\"43.02065707992864%\" y=\"40\" height=\"20\" width=\"48.64600547539197%\">  <svg x=\"0\" y=\"0\" width=\"100%\" height=\"100%\">    <text x=\"50%\" y=\"9\" font-size=\"12px\" fill=\"rgb(255,255,255)\" dominant-baseline=\"middle\" text-anchor=\"middle\">test</text>  </svg></svg><line x1=\"8.333434061311284%\" x2=\"43.02065707992864%\" y1=\"60\" y2=\"60\" id=\"_fb_bciuudcooikaigouvfhx_ind_2\" style=\"stroke:rgb(255.0, 0.0, 81.08083606031792);stroke-width:2; opacity: 0\"/><text x=\"25.67704557061996%\" y=\"71\" font-size=\"12px\" id=\"_fs_bciuudcooikaigouvfhx_ind_2\" fill=\"rgb(255.0, 0.0, 81.08083606031792)\" style=\"opacity: 0\" dominant-baseline=\"middle\" text-anchor=\"middle\">0.251</text><svg x=\"8.333434061311284%\" y=\"40\" height=\"20\" width=\"34.68722301861736%\">  <svg x=\"0\" y=\"0\" width=\"100%\" height=\"100%\">    <text x=\"50%\" y=\"9\" font-size=\"12px\" fill=\"rgb(255,255,255)\" dominant-baseline=\"middle\" text-anchor=\"middle\">text</text>  </svg></svg><line x1=\"8.33333333333333%\" x2=\"8.333434061311284%\" y1=\"60\" y2=\"60\" id=\"_fb_bciuudcooikaigouvfhx_ind_0\" style=\"stroke:rgb(255.0, 0.0, 81.08083606031792);stroke-width:2; opacity: 0\"/><text x=\"8.333383697322308%\" y=\"71\" font-size=\"12px\" id=\"_fs_bciuudcooikaigouvfhx_ind_0\" fill=\"rgb(255.0, 0.0, 81.08083606031792)\" style=\"opacity: 0\" dominant-baseline=\"middle\" text-anchor=\"middle\">0.0</text><svg x=\"8.33333333333333%\" y=\"40\" height=\"20\" width=\"0.00010072797795324107%\">  <svg x=\"0\" y=\"0\" width=\"100%\" height=\"100%\">    <text x=\"50%\" y=\"9\" font-size=\"12px\" fill=\"rgb(255,255,255)\" dominant-baseline=\"middle\" text-anchor=\"middle\"></text>  </svg></svg><g transform=\"translate(0,0)\">  <svg x=\"43.02065707992864%\" y=\"40\" height=\"18\" overflow=\"visible\" width=\"30\">    <path d=\"M 0 -9 l 6 18 L 0 25\" fill=\"none\" style=\"stroke:rgb(255.0, 0.0, 81.08083606031792);stroke-width:2\" />  </svg></g><g transform=\"translate(2,0)\">  <svg x=\"43.02065707992864%\" y=\"40\" height=\"18\" overflow=\"visible\" width=\"30\">    <path d=\"M 0 -9 l 6 18 L 0 25\" fill=\"none\" style=\"stroke:rgb(255.0, 0.0, 81.08083606031792);stroke-width:2\" />  </svg></g><g transform=\"translate(4,0)\">  <svg x=\"43.02065707992864%\" y=\"40\" height=\"18\" overflow=\"visible\" width=\"30\">    <path d=\"M 0 -9 l 6 18 L 0 25\" fill=\"none\" style=\"stroke:rgb(255.0, 0.0, 81.08083606031792);stroke-width:2\" />  </svg></g><g transform=\"translate(6,0)\">  <svg x=\"43.02065707992864%\" y=\"40\" height=\"18\" overflow=\"visible\" width=\"30\">    <path d=\"M 0 -9 l 6 18 L 0 25\" fill=\"none\" style=\"stroke:rgb(255.0, 0.0, 81.08083606031792);stroke-width:2\" />  </svg></g><g transform=\"translate(-8,0)\">  <svg x=\"43.02065707992864%\" y=\"40\" height=\"18\" overflow=\"visible\" width=\"30\">    <path d=\"M 0 -9 l 6 18 L 0 25\" fill=\"none\" style=\"stroke:rgb(255.0, 0.0, 81.08083606031792);stroke-width:2\" />  </svg></g><g transform=\"translate(-6,0)\">  <svg x=\"43.02065707992864%\" y=\"40\" height=\"18\" overflow=\"visible\" width=\"30\">    <path d=\"M 0 -9 l 6 18 L 0 25\" fill=\"none\" style=\"stroke:rgb(255.0, 0.0, 81.08083606031792);stroke-width:2\" />  </svg></g><g transform=\"translate(-4,0)\">  <svg x=\"43.02065707992864%\" y=\"40\" height=\"18\" overflow=\"visible\" width=\"30\">    <path d=\"M 0 -9 l 6 18 L 0 25\" fill=\"none\" style=\"stroke:rgb(255.0, 0.0, 81.08083606031792);stroke-width:2\" />  </svg></g><g transform=\"translate(-2,0)\">  <svg x=\"43.02065707992864%\" y=\"40\" height=\"18\" overflow=\"visible\" width=\"30\">    <path d=\"M 0 -9 l 6 18 L 0 25\" fill=\"none\" style=\"stroke:rgb(255.0, 0.0, 81.08083606031792);stroke-width:2\" />  </svg></g><g transform=\"translate(0,0)\">  <svg x=\"8.333434061311284%\" y=\"40\" height=\"18\" overflow=\"visible\" width=\"30\">    <path d=\"M 0 -9 l 6 18 L 0 25\" fill=\"none\" style=\"stroke:rgb(255.0, 0.0, 81.08083606031792);stroke-width:2\" />  </svg></g><g transform=\"translate(2,0)\">  <svg x=\"8.333434061311284%\" y=\"40\" height=\"18\" overflow=\"visible\" width=\"30\">    <path d=\"M 0 -9 l 6 18 L 0 25\" fill=\"none\" style=\"stroke:rgb(255.0, 0.0, 81.08083606031792);stroke-width:2\" />  </svg></g><g transform=\"translate(4,0)\">  <svg x=\"8.333434061311284%\" y=\"40\" height=\"18\" overflow=\"visible\" width=\"30\">    <path d=\"M 0 -9 l 6 18 L 0 25\" fill=\"none\" style=\"stroke:rgb(255.0, 0.0, 81.08083606031792);stroke-width:2\" />  </svg></g><g transform=\"translate(6,0)\">  <svg x=\"8.333434061311284%\" y=\"40\" height=\"18\" overflow=\"visible\" width=\"30\">    <path d=\"M 0 -9 l 6 18 L 0 25\" fill=\"none\" style=\"stroke:rgb(255.0, 0.0, 81.08083606031792);stroke-width:2\" />  </svg></g><g transform=\"translate(-8,0)\">  <svg x=\"8.333434061311284%\" y=\"40\" height=\"18\" overflow=\"visible\" width=\"30\">    <path d=\"M 0 -9 l 6 18 L 0 25\" fill=\"none\" style=\"stroke:rgb(255.0, 0.0, 81.08083606031792);stroke-width:2\" />  </svg></g><g transform=\"translate(-6,0)\">  <svg x=\"8.333434061311284%\" y=\"40\" height=\"18\" overflow=\"visible\" width=\"30\">    <path d=\"M 0 -9 l 6 18 L 0 25\" fill=\"none\" style=\"stroke:rgb(255.0, 0.0, 81.08083606031792);stroke-width:2\" />  </svg></g><g transform=\"translate(-4,0)\">  <svg x=\"8.333434061311284%\" y=\"40\" height=\"18\" overflow=\"visible\" width=\"30\">    <path d=\"M 0 -9 l 6 18 L 0 25\" fill=\"none\" style=\"stroke:rgb(255.0, 0.0, 81.08083606031792);stroke-width:2\" />  </svg></g><g transform=\"translate(-2,0)\">  <svg x=\"8.333434061311284%\" y=\"40\" height=\"18\" overflow=\"visible\" width=\"30\">    <path d=\"M 0 -9 l 6 18 L 0 25\" fill=\"none\" style=\"stroke:rgb(255.0, 0.0, 81.08083606031792);stroke-width:2\" />  </svg></g><rect transform=\"translate(-8,0)\" x=\"91.66666255532061%\" y=\"40\" width=\"8\" height=\"18\" style=\"fill:rgb(255.0, 0.0, 81.08083606031792)\"/><g transform=\"translate(-11.5,0)\">  <svg x=\"8.33333333333333%\" y=\"40\" height=\"18\" overflow=\"visible\" width=\"30\">    <path d=\"M 10 -9 l 6 18 L 10 25 L 0 25 L 0 -9\" fill=\"#ffffff\" style=\"stroke:rgb(255,255,255);stroke-width:2\" />  </svg></g><g transform=\"translate(-1.5,0)\">  <svg x=\"91.66666255532061%\" y=\"40\" height=\"18\" overflow=\"visible\" width=\"30\">    <path d=\"M 0 -9 l 6 18 L 0 25\" fill=\"none\" style=\"stroke:rgb(255, 195, 213);stroke-width:2\" />  </svg></g><rect x=\"43.02065707992864%\" y=\"40\" height=\"20\" width=\"48.64600547539197%\"      onmouseover=\"document.getElementById('_tp_bciuudcooikaigouvfhx_ind_1').style.textDecoration = 'underline';document.getElementById('_fs_bciuudcooikaigouvfhx_ind_1').style.opacity = 1;document.getElementById('_fb_bciuudcooikaigouvfhx_ind_1').style.opacity = 1;\"      onmouseout=\"document.getElementById('_tp_bciuudcooikaigouvfhx_ind_1').style.textDecoration = 'none';document.getElementById('_fs_bciuudcooikaigouvfhx_ind_1').style.opacity = 0;document.getElementById('_fb_bciuudcooikaigouvfhx_ind_1').style.opacity = 0;\" style=\"fill:rgb(0,0,0,0)\" /><g transform=\"translate(-1.5,0)\">  <svg x=\"43.02065707992864%\" y=\"40\" height=\"18\" overflow=\"visible\" width=\"30\">    <path d=\"M 0 -9 l 6 18 L 0 25\" fill=\"none\" style=\"stroke:rgb(255, 195, 213);stroke-width:2\" />  </svg></g><rect x=\"8.333434061311284%\" y=\"40\" height=\"20\" width=\"34.68722301861736%\"      onmouseover=\"document.getElementById('_tp_bciuudcooikaigouvfhx_ind_2').style.textDecoration = 'underline';document.getElementById('_fs_bciuudcooikaigouvfhx_ind_2').style.opacity = 1;document.getElementById('_fb_bciuudcooikaigouvfhx_ind_2').style.opacity = 1;\"      onmouseout=\"document.getElementById('_tp_bciuudcooikaigouvfhx_ind_2').style.textDecoration = 'none';document.getElementById('_fs_bciuudcooikaigouvfhx_ind_2').style.opacity = 0;document.getElementById('_fb_bciuudcooikaigouvfhx_ind_2').style.opacity = 0;\" style=\"fill:rgb(0,0,0,0)\" /><rect x=\"8.33333333333333%\" y=\"40\" height=\"20\" width=\"0.00010072797795324107%\"      onmouseover=\"document.getElementById('_tp_bciuudcooikaigouvfhx_ind_0').style.textDecoration = 'underline';document.getElementById('_fs_bciuudcooikaigouvfhx_ind_0').style.opacity = 1;document.getElementById('_fb_bciuudcooikaigouvfhx_ind_0').style.opacity = 1;\"      onmouseout=\"document.getElementById('_tp_bciuudcooikaigouvfhx_ind_0').style.textDecoration = 'none';document.getElementById('_fs_bciuudcooikaigouvfhx_ind_0').style.opacity = 0;document.getElementById('_fb_bciuudcooikaigouvfhx_ind_0').style.opacity = 0;\" style=\"fill:rgb(0,0,0,0)\" /><rect x=\"91.66666255532061%\" width=\"4.111346038905568e-06%\" y=\"40\" height=\"18\" style=\"fill:rgb(0.0, 138.56128015770724, 250.76166088685727); stroke-width:0; stroke:rgb(0,0,0)\" /><line x1=\"91.66666255532061%\" x2=\"91.66666666666666%\" y1=\"60\" y2=\"60\" id=\"_fb_bciuudcooikaigouvfhx_ind_3\" style=\"stroke:rgb(0.0, 138.56128015770724, 250.76166088685727);stroke-width:2; opacity: 0\"/><text x=\"91.66666461099364%\" y=\"71\" font-size=\"12px\" fill=\"rgb(0.0, 138.56128015770724, 250.76166088685727)\" id=\"_fs_bciuudcooikaigouvfhx_ind_3\" style=\"opacity: 0\" dominant-baseline=\"middle\" text-anchor=\"middle\">-0.0</text><svg x=\"91.66666255532061%\" y=\"40\" height=\"20\" width=\"4.111346044055608e-06%\">  <svg x=\"0\" y=\"0\" width=\"100%\" height=\"100%\">    <text x=\"50%\" y=\"9\" font-size=\"12px\" fill=\"rgb(255,255,255)\" dominant-baseline=\"middle\" text-anchor=\"middle\"></text>  </svg></svg><rect transform=\"translate(0,0)\" x=\"91.66666255532061%\" y=\"40\" width=\"8\" height=\"18\" style=\"fill:rgb(0.0, 138.56128015770724, 250.76166088685727)\"/><g transform=\"translate(-6.0,0)\">  <svg x=\"91.66666666666666%\" y=\"40\" height=\"18\" overflow=\"visible\" width=\"30\">    <path d=\"M 8 -9 l -6 18 L 8 25 L 20 25 L 20 -9\" fill=\"#ffffff\" style=\"stroke:rgb(255,255,255);stroke-width:2\" />  </svg></g><rect x=\"91.66666255532061%\" y=\"40\" height=\"20\" width=\"4.111346044055608e-06%\"      onmouseover=\"document.getElementById('_tp_bciuudcooikaigouvfhx_ind_3').style.textDecoration = 'underline';document.getElementById('_fs_bciuudcooikaigouvfhx_ind_3').style.opacity = 1;document.getElementById('_fb_bciuudcooikaigouvfhx_ind_3').style.opacity = 1;\"      onmouseout=\"document.getElementById('_tp_bciuudcooikaigouvfhx_ind_3').style.textDecoration = 'none';document.getElementById('_fs_bciuudcooikaigouvfhx_ind_3').style.opacity = 0;document.getElementById('_fb_bciuudcooikaigouvfhx_ind_3').style.opacity = 0;\" style=\"fill:rgb(0,0,0,0)\" /></svg><div style='display: inline; text-align: center;'><div style='display: none; color: #999; padding-top: 0px; font-size: 12px;'>0.0</div><div id='_tp_bciuudcooikaigouvfhx_ind_0'style='display: inline; background: rgba(230.2941176470614, 26.505882352939775, 102.59215686274348, 0.0); border-radius: 3px; padding: 0px'onclick=\"if (this.previousSibling.style.display == 'none') {this.previousSibling.style.display = 'block';this.parentNode.style.display = 'inline-block';} else {this.previousSibling.style.display = 'none';this.parentNode.style.display = 'inline';}\"onmouseover=\"document.getElementById('_fb_bciuudcooikaigouvfhx_ind_0').style.opacity = 1; document.getElementById('_fs_bciuudcooikaigouvfhx_ind_0').style.opacity = 1;\"onmouseout=\"document.getElementById('_fb_bciuudcooikaigouvfhx_ind_0').style.opacity = 0; document.getElementById('_fs_bciuudcooikaigouvfhx_ind_0').style.opacity = 0;\"></div></div><div style='display: inline; text-align: center;'><div style='display: none; color: #999; padding-top: 0px; font-size: 12px;'>0.353</div><div id='_tp_bciuudcooikaigouvfhx_ind_1'style='display: inline; background: rgba(255.0, 13.0, 87.0, 1.0); border-radius: 3px; padding: 0px'onclick=\"if (this.previousSibling.style.display == 'none') {this.previousSibling.style.display = 'block';this.parentNode.style.display = 'inline-block';} else {this.previousSibling.style.display = 'none';this.parentNode.style.display = 'inline';}\"onmouseover=\"document.getElementById('_fb_bciuudcooikaigouvfhx_ind_1').style.opacity = 1; document.getElementById('_fs_bciuudcooikaigouvfhx_ind_1').style.opacity = 1;\"onmouseout=\"document.getElementById('_fb_bciuudcooikaigouvfhx_ind_1').style.opacity = 0; document.getElementById('_fs_bciuudcooikaigouvfhx_ind_1').style.opacity = 0;\">test </div></div><div style='display: inline; text-align: center;'><div style='display: none; color: #999; padding-top: 0px; font-size: 12px;'>0.251</div><div id='_tp_bciuudcooikaigouvfhx_ind_2'style='display: inline; background: rgba(255.0, 13.0, 87.0, 0.7162210338680925); border-radius: 3px; padding: 0px'onclick=\"if (this.previousSibling.style.display == 'none') {this.previousSibling.style.display = 'block';this.parentNode.style.display = 'inline-block';} else {this.previousSibling.style.display = 'none';this.parentNode.style.display = 'inline';}\"onmouseover=\"document.getElementById('_fb_bciuudcooikaigouvfhx_ind_2').style.opacity = 1; document.getElementById('_fs_bciuudcooikaigouvfhx_ind_2').style.opacity = 1;\"onmouseout=\"document.getElementById('_fb_bciuudcooikaigouvfhx_ind_2').style.opacity = 0; document.getElementById('_fs_bciuudcooikaigouvfhx_ind_2').style.opacity = 0;\">text</div></div><div style='display: inline; text-align: center;'><div style='display: none; color: #999; padding-top: 0px; font-size: 12px;'>-0.0</div><div id='_tp_bciuudcooikaigouvfhx_ind_3'style='display: inline; background: rgba(54.70588235294111, 122.49411764705886, 213.40784313725496, 0.0); border-radius: 3px; padding: 0px'onclick=\"if (this.previousSibling.style.display == 'none') {this.previousSibling.style.display = 'block';this.parentNode.style.display = 'inline-block';} else {this.previousSibling.style.display = 'none';this.parentNode.style.display = 'inline';}\"onmouseover=\"document.getElementById('_fb_bciuudcooikaigouvfhx_ind_3').style.opacity = 1; document.getElementById('_fs_bciuudcooikaigouvfhx_ind_3').style.opacity = 1;\"onmouseout=\"document.getElementById('_fb_bciuudcooikaigouvfhx_ind_3').style.opacity = 0; document.getElementById('_fs_bciuudcooikaigouvfhx_ind_3').style.opacity = 0;\"></div></div>"
      ],
      "text/plain": [
       "<IPython.core.display.HTML object>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "shap.plots.text(test_custom_object)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 106,
   "id": "ab06f0be",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "  0%|          | 0/48 [00:00<?, ?it/s]"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Partition explainer: 2it [00:46, 46.16s/it]                                                                             \n"
     ]
    }
   ],
   "source": [
    "new_shap_value = explainer(['this is covid during summer'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 92,
   "id": "6d7715c5",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<svg width=\"100%\" height=\"80px\"><line x1=\"0\" y1=\"33\" x2=\"100%\" y2=\"33\" style=\"stroke:rgb(150,150,150);stroke-width:1\" /><line x1=\"31.681603%\" y1=\"33\" x2=\"31.681603%\" y2=\"37\" style=\"stroke:rgb(150,150,150);stroke-width:1\" /><text x=\"31.681603%\" y=\"27\" font-size=\"12px\" fill=\"rgb(120,120,120)\" dominant-baseline=\"bottom\" text-anchor=\"middle\">4.063286</text><text x=\"31.681603%\" y=\"10\" font-size=\"12px\" fill=\"rgb(120,120,120)\" dominant-baseline=\"bottom\" text-anchor=\"middle\">base value</text><line x1=\"17.395888%\" y1=\"33\" x2=\"17.395888%\" y2=\"37\" style=\"stroke:rgb(150,150,150);stroke-width:1\" /><text x=\"17.395888%\" y=\"27\" font-size=\"12px\" fill=\"rgb(120,120,120)\" dominant-baseline=\"bottom\" text-anchor=\"middle\">3.179137</text><line x1=\"45.967317%\" y1=\"33\" x2=\"45.967317%\" y2=\"37\" style=\"stroke:rgb(150,150,150);stroke-width:1\" /><text x=\"45.967317%\" y=\"27\" font-size=\"12px\" fill=\"rgb(120,120,120)\" dominant-baseline=\"bottom\" text-anchor=\"middle\">4.947434</text><line x1=\"60.253031%\" y1=\"33\" x2=\"60.253031%\" y2=\"37\" style=\"stroke:rgb(150,150,150);stroke-width:1\" /><text x=\"60.253031%\" y=\"27\" font-size=\"12px\" fill=\"rgb(120,120,120)\" dominant-baseline=\"bottom\" text-anchor=\"middle\">5.831583</text><line x1=\"74.538746%\" y1=\"33\" x2=\"74.538746%\" y2=\"37\" style=\"stroke:rgb(150,150,150);stroke-width:1\" /><text x=\"74.538746%\" y=\"27\" font-size=\"12px\" fill=\"rgb(120,120,120)\" dominant-baseline=\"bottom\" text-anchor=\"middle\">6.715731</text><line x1=\"88.824460%\" y1=\"33\" x2=\"88.824460%\" y2=\"37\" style=\"stroke:rgb(150,150,150);stroke-width:1\" /><text x=\"88.824460%\" y=\"27\" font-size=\"12px\" fill=\"rgb(120,120,120)\" dominant-baseline=\"bottom\" text-anchor=\"middle\">7.599880</text><line x1=\"68.318397%\" y1=\"33\" x2=\"68.318397%\" y2=\"37\" style=\"stroke:rgb(150,150,150);stroke-width:1\" /><text x=\"68.318397%\" y=\"27\" font-size=\"13px\" style=\"stroke:#ffffff;stroke-width:8px;\" font-weight=\"bold\" fill=\"rgb(255,255,255)\" dominant-baseline=\"bottom\" text-anchor=\"middle\">6.330751</text><text x=\"68.318397%\" y=\"27\" font-size=\"13px\" font-weight=\"bold\" fill=\"rgb(0,0,0)\" dominant-baseline=\"bottom\" text-anchor=\"middle\">6.330751</text><text x=\"68.318397%\" y=\"10\" font-size=\"12px\" fill=\"rgb(120,120,120)\" dominant-baseline=\"bottom\" text-anchor=\"middle\">f(x)</text><rect x=\"8.333333333333334%\" width=\"59.98506397389824%\" y=\"40\" height=\"18\" style=\"fill:rgb(255.0, 0.0, 81.08083606031792); stroke-width:0; stroke:rgb(0,0,0)\" /><line x1=\"37.28225745500682%\" x2=\"68.31839730723158%\" y1=\"60\" y2=\"60\" id=\"_fb_hovdgrwtobenpfinrmnc_ind_3\" style=\"stroke:rgb(255.0, 0.0, 81.08083606031792);stroke-width:2; opacity: 0\"/><text x=\"52.8003273811192%\" y=\"71\" font-size=\"12px\" id=\"_fs_hovdgrwtobenpfinrmnc_ind_3\" fill=\"rgb(255.0, 0.0, 81.08083606031792)\" style=\"opacity: 0\" dominant-baseline=\"middle\" text-anchor=\"middle\">1.921</text><svg x=\"37.28225745500682%\" y=\"40\" height=\"20\" width=\"31.036139852224757%\">  <svg x=\"0\" y=\"0\" width=\"100%\" height=\"100%\">    <text x=\"50%\" y=\"9\" font-size=\"12px\" fill=\"rgb(255,255,255)\" dominant-baseline=\"middle\" text-anchor=\"middle\">vid</text>  </svg></svg><line x1=\"8.333662702525457%\" x2=\"37.28225745500682%\" y1=\"60\" y2=\"60\" id=\"_fb_hovdgrwtobenpfinrmnc_ind_2\" style=\"stroke:rgb(255.0, 0.0, 81.08083606031792);stroke-width:2; opacity: 0\"/><text x=\"22.80796007876614%\" y=\"71\" font-size=\"12px\" id=\"_fs_hovdgrwtobenpfinrmnc_ind_2\" fill=\"rgb(255.0, 0.0, 81.08083606031792)\" style=\"opacity: 0\" dominant-baseline=\"middle\" text-anchor=\"middle\">1.792</text><svg x=\"8.333662702525457%\" y=\"40\" height=\"20\" width=\"28.948594752481362%\">  <svg x=\"0\" y=\"0\" width=\"100%\" height=\"100%\">    <text x=\"50%\" y=\"9\" font-size=\"12px\" fill=\"rgb(255,255,255)\" dominant-baseline=\"middle\" text-anchor=\"middle\">co</text>  </svg></svg><line x1=\"8.333391117402126%\" x2=\"8.333662702525457%\" y1=\"60\" y2=\"60\" id=\"_fb_hovdgrwtobenpfinrmnc_ind_0\" style=\"stroke:rgb(255.0, 0.0, 81.08083606031792);stroke-width:2; opacity: 0\"/><text x=\"8.33352690996379%\" y=\"71\" font-size=\"12px\" id=\"_fs_hovdgrwtobenpfinrmnc_ind_0\" fill=\"rgb(255.0, 0.0, 81.08083606031792)\" style=\"opacity: 0\" dominant-baseline=\"middle\" text-anchor=\"middle\">0.0</text><svg x=\"8.333391117402126%\" y=\"40\" height=\"20\" width=\"0.00027158512333080864%\">  <svg x=\"0\" y=\"0\" width=\"100%\" height=\"100%\">    <text x=\"50%\" y=\"9\" font-size=\"12px\" fill=\"rgb(255,255,255)\" dominant-baseline=\"middle\" text-anchor=\"middle\"></text>  </svg></svg><line x1=\"8.333333333333334%\" x2=\"8.333391117402126%\" y1=\"60\" y2=\"60\" id=\"_fb_hovdgrwtobenpfinrmnc_ind_5\" style=\"stroke:rgb(255.0, 0.0, 81.08083606031792);stroke-width:2; opacity: 0\"/><text x=\"8.333362225367729%\" y=\"71\" font-size=\"12px\" id=\"_fs_hovdgrwtobenpfinrmnc_ind_5\" fill=\"rgb(255.0, 0.0, 81.08083606031792)\" style=\"opacity: 0\" dominant-baseline=\"middle\" text-anchor=\"middle\">0.0</text><svg x=\"8.333333333333334%\" y=\"40\" height=\"20\" width=\"5.7784068792088306e-05%\">  <svg x=\"0\" y=\"0\" width=\"100%\" height=\"100%\">    <text x=\"50%\" y=\"9\" font-size=\"12px\" fill=\"rgb(255,255,255)\" dominant-baseline=\"middle\" text-anchor=\"middle\"></text>  </svg></svg><g transform=\"translate(0,0)\">  <svg x=\"37.28225745500682%\" y=\"40\" height=\"18\" overflow=\"visible\" width=\"30\">    <path d=\"M 0 -9 l 6 18 L 0 25\" fill=\"none\" style=\"stroke:rgb(255.0, 0.0, 81.08083606031792);stroke-width:2\" />  </svg></g><g transform=\"translate(2,0)\">  <svg x=\"37.28225745500682%\" y=\"40\" height=\"18\" overflow=\"visible\" width=\"30\">    <path d=\"M 0 -9 l 6 18 L 0 25\" fill=\"none\" style=\"stroke:rgb(255.0, 0.0, 81.08083606031792);stroke-width:2\" />  </svg></g><g transform=\"translate(4,0)\">  <svg x=\"37.28225745500682%\" y=\"40\" height=\"18\" overflow=\"visible\" width=\"30\">    <path d=\"M 0 -9 l 6 18 L 0 25\" fill=\"none\" style=\"stroke:rgb(255.0, 0.0, 81.08083606031792);stroke-width:2\" />  </svg></g><g transform=\"translate(6,0)\">  <svg x=\"37.28225745500682%\" y=\"40\" height=\"18\" overflow=\"visible\" width=\"30\">    <path d=\"M 0 -9 l 6 18 L 0 25\" fill=\"none\" style=\"stroke:rgb(255.0, 0.0, 81.08083606031792);stroke-width:2\" />  </svg></g><g transform=\"translate(-8,0)\">  <svg x=\"37.28225745500682%\" y=\"40\" height=\"18\" overflow=\"visible\" width=\"30\">    <path d=\"M 0 -9 l 6 18 L 0 25\" fill=\"none\" style=\"stroke:rgb(255.0, 0.0, 81.08083606031792);stroke-width:2\" />  </svg></g><g transform=\"translate(-6,0)\">  <svg x=\"37.28225745500682%\" y=\"40\" height=\"18\" overflow=\"visible\" width=\"30\">    <path d=\"M 0 -9 l 6 18 L 0 25\" fill=\"none\" style=\"stroke:rgb(255.0, 0.0, 81.08083606031792);stroke-width:2\" />  </svg></g><g transform=\"translate(-4,0)\">  <svg x=\"37.28225745500682%\" y=\"40\" height=\"18\" overflow=\"visible\" width=\"30\">    <path d=\"M 0 -9 l 6 18 L 0 25\" fill=\"none\" style=\"stroke:rgb(255.0, 0.0, 81.08083606031792);stroke-width:2\" />  </svg></g><g transform=\"translate(-2,0)\">  <svg x=\"37.28225745500682%\" y=\"40\" height=\"18\" overflow=\"visible\" width=\"30\">    <path d=\"M 0 -9 l 6 18 L 0 25\" fill=\"none\" style=\"stroke:rgb(255.0, 0.0, 81.08083606031792);stroke-width:2\" />  </svg></g><g transform=\"translate(0,0)\">  <svg x=\"8.333662702525457%\" y=\"40\" height=\"18\" overflow=\"visible\" width=\"30\">    <path d=\"M 0 -9 l 6 18 L 0 25\" fill=\"none\" style=\"stroke:rgb(255.0, 0.0, 81.08083606031792);stroke-width:2\" />  </svg></g><g transform=\"translate(2,0)\">  <svg x=\"8.333662702525457%\" y=\"40\" height=\"18\" overflow=\"visible\" width=\"30\">    <path d=\"M 0 -9 l 6 18 L 0 25\" fill=\"none\" style=\"stroke:rgb(255.0, 0.0, 81.08083606031792);stroke-width:2\" />  </svg></g><g transform=\"translate(4,0)\">  <svg x=\"8.333662702525457%\" y=\"40\" height=\"18\" overflow=\"visible\" width=\"30\">    <path d=\"M 0 -9 l 6 18 L 0 25\" fill=\"none\" style=\"stroke:rgb(255.0, 0.0, 81.08083606031792);stroke-width:2\" />  </svg></g><g transform=\"translate(6,0)\">  <svg x=\"8.333662702525457%\" y=\"40\" height=\"18\" overflow=\"visible\" width=\"30\">    <path d=\"M 0 -9 l 6 18 L 0 25\" fill=\"none\" style=\"stroke:rgb(255.0, 0.0, 81.08083606031792);stroke-width:2\" />  </svg></g><g transform=\"translate(-8,0)\">  <svg x=\"8.333662702525457%\" y=\"40\" height=\"18\" overflow=\"visible\" width=\"30\">    <path d=\"M 0 -9 l 6 18 L 0 25\" fill=\"none\" style=\"stroke:rgb(255.0, 0.0, 81.08083606031792);stroke-width:2\" />  </svg></g><g transform=\"translate(-6,0)\">  <svg x=\"8.333662702525457%\" y=\"40\" height=\"18\" overflow=\"visible\" width=\"30\">    <path d=\"M 0 -9 l 6 18 L 0 25\" fill=\"none\" style=\"stroke:rgb(255.0, 0.0, 81.08083606031792);stroke-width:2\" />  </svg></g><g transform=\"translate(-4,0)\">  <svg x=\"8.333662702525457%\" y=\"40\" height=\"18\" overflow=\"visible\" width=\"30\">    <path d=\"M 0 -9 l 6 18 L 0 25\" fill=\"none\" style=\"stroke:rgb(255.0, 0.0, 81.08083606031792);stroke-width:2\" />  </svg></g><g transform=\"translate(-2,0)\">  <svg x=\"8.333662702525457%\" y=\"40\" height=\"18\" overflow=\"visible\" width=\"30\">    <path d=\"M 0 -9 l 6 18 L 0 25\" fill=\"none\" style=\"stroke:rgb(255.0, 0.0, 81.08083606031792);stroke-width:2\" />  </svg></g><g transform=\"translate(0,0)\">  <svg x=\"8.333391117402126%\" y=\"40\" height=\"18\" overflow=\"visible\" width=\"30\">    <path d=\"M 0 -9 l 6 18 L 0 25\" fill=\"none\" style=\"stroke:rgb(255.0, 0.0, 81.08083606031792);stroke-width:2\" />  </svg></g><g transform=\"translate(2,0)\">  <svg x=\"8.333391117402126%\" y=\"40\" height=\"18\" overflow=\"visible\" width=\"30\">    <path d=\"M 0 -9 l 6 18 L 0 25\" fill=\"none\" style=\"stroke:rgb(255.0, 0.0, 81.08083606031792);stroke-width:2\" />  </svg></g><g transform=\"translate(4,0)\">  <svg x=\"8.333391117402126%\" y=\"40\" height=\"18\" overflow=\"visible\" width=\"30\">    <path d=\"M 0 -9 l 6 18 L 0 25\" fill=\"none\" style=\"stroke:rgb(255.0, 0.0, 81.08083606031792);stroke-width:2\" />  </svg></g><g transform=\"translate(6,0)\">  <svg x=\"8.333391117402126%\" y=\"40\" height=\"18\" overflow=\"visible\" width=\"30\">    <path d=\"M 0 -9 l 6 18 L 0 25\" fill=\"none\" style=\"stroke:rgb(255.0, 0.0, 81.08083606031792);stroke-width:2\" />  </svg></g><g transform=\"translate(-8,0)\">  <svg x=\"8.333391117402126%\" y=\"40\" height=\"18\" overflow=\"visible\" width=\"30\">    <path d=\"M 0 -9 l 6 18 L 0 25\" fill=\"none\" style=\"stroke:rgb(255.0, 0.0, 81.08083606031792);stroke-width:2\" />  </svg></g><g transform=\"translate(-6,0)\">  <svg x=\"8.333391117402126%\" y=\"40\" height=\"18\" overflow=\"visible\" width=\"30\">    <path d=\"M 0 -9 l 6 18 L 0 25\" fill=\"none\" style=\"stroke:rgb(255.0, 0.0, 81.08083606031792);stroke-width:2\" />  </svg></g><g transform=\"translate(-4,0)\">  <svg x=\"8.333391117402126%\" y=\"40\" height=\"18\" overflow=\"visible\" width=\"30\">    <path d=\"M 0 -9 l 6 18 L 0 25\" fill=\"none\" style=\"stroke:rgb(255.0, 0.0, 81.08083606031792);stroke-width:2\" />  </svg></g><g transform=\"translate(-2,0)\">  <svg x=\"8.333391117402126%\" y=\"40\" height=\"18\" overflow=\"visible\" width=\"30\">    <path d=\"M 0 -9 l 6 18 L 0 25\" fill=\"none\" style=\"stroke:rgb(255.0, 0.0, 81.08083606031792);stroke-width:2\" />  </svg></g><rect transform=\"translate(-8,0)\" x=\"68.31839730723158%\" y=\"40\" width=\"8\" height=\"18\" style=\"fill:rgb(255.0, 0.0, 81.08083606031792)\"/><g transform=\"translate(-11.5,0)\">  <svg x=\"8.333333333333334%\" y=\"40\" height=\"18\" overflow=\"visible\" width=\"30\">    <path d=\"M 10 -9 l 6 18 L 10 25 L 0 25 L 0 -9\" fill=\"#ffffff\" style=\"stroke:rgb(255,255,255);stroke-width:2\" />  </svg></g><g transform=\"translate(-1.5,0)\">  <svg x=\"68.31839730723158%\" y=\"40\" height=\"18\" overflow=\"visible\" width=\"30\">    <path d=\"M 0 -9 l 6 18 L 0 25\" fill=\"none\" style=\"stroke:rgb(255, 195, 213);stroke-width:2\" />  </svg></g><rect x=\"37.28225745500682%\" y=\"40\" height=\"20\" width=\"31.036139852224757%\"      onmouseover=\"document.getElementById('_tp_hovdgrwtobenpfinrmnc_ind_3').style.textDecoration = 'underline';document.getElementById('_fs_hovdgrwtobenpfinrmnc_ind_3').style.opacity = 1;document.getElementById('_fb_hovdgrwtobenpfinrmnc_ind_3').style.opacity = 1;\"      onmouseout=\"document.getElementById('_tp_hovdgrwtobenpfinrmnc_ind_3').style.textDecoration = 'none';document.getElementById('_fs_hovdgrwtobenpfinrmnc_ind_3').style.opacity = 0;document.getElementById('_fb_hovdgrwtobenpfinrmnc_ind_3').style.opacity = 0;\" style=\"fill:rgb(0,0,0,0)\" /><g transform=\"translate(-1.5,0)\">  <svg x=\"37.28225745500682%\" y=\"40\" height=\"18\" overflow=\"visible\" width=\"30\">    <path d=\"M 0 -9 l 6 18 L 0 25\" fill=\"none\" style=\"stroke:rgb(255, 195, 213);stroke-width:2\" />  </svg></g><rect x=\"8.333662702525457%\" y=\"40\" height=\"20\" width=\"28.948594752481362%\"      onmouseover=\"document.getElementById('_tp_hovdgrwtobenpfinrmnc_ind_2').style.textDecoration = 'underline';document.getElementById('_fs_hovdgrwtobenpfinrmnc_ind_2').style.opacity = 1;document.getElementById('_fb_hovdgrwtobenpfinrmnc_ind_2').style.opacity = 1;\"      onmouseout=\"document.getElementById('_tp_hovdgrwtobenpfinrmnc_ind_2').style.textDecoration = 'none';document.getElementById('_fs_hovdgrwtobenpfinrmnc_ind_2').style.opacity = 0;document.getElementById('_fb_hovdgrwtobenpfinrmnc_ind_2').style.opacity = 0;\" style=\"fill:rgb(0,0,0,0)\" /><g transform=\"translate(-1.5,0)\">  <svg x=\"8.333662702525457%\" y=\"40\" height=\"18\" overflow=\"visible\" width=\"30\">    <path d=\"M 0 -9 l 6 18 L 0 25\" fill=\"none\" style=\"stroke:rgb(255, 195, 213);stroke-width:2\" />  </svg></g><rect x=\"8.333391117402126%\" y=\"40\" height=\"20\" width=\"0.00027158512333080864%\"      onmouseover=\"document.getElementById('_tp_hovdgrwtobenpfinrmnc_ind_0').style.textDecoration = 'underline';document.getElementById('_fs_hovdgrwtobenpfinrmnc_ind_0').style.opacity = 1;document.getElementById('_fb_hovdgrwtobenpfinrmnc_ind_0').style.opacity = 1;\"      onmouseout=\"document.getElementById('_tp_hovdgrwtobenpfinrmnc_ind_0').style.textDecoration = 'none';document.getElementById('_fs_hovdgrwtobenpfinrmnc_ind_0').style.opacity = 0;document.getElementById('_fb_hovdgrwtobenpfinrmnc_ind_0').style.opacity = 0;\" style=\"fill:rgb(0,0,0,0)\" /><rect x=\"8.333333333333334%\" y=\"40\" height=\"20\" width=\"5.7784068792088306e-05%\"      onmouseover=\"document.getElementById('_tp_hovdgrwtobenpfinrmnc_ind_5').style.textDecoration = 'underline';document.getElementById('_fs_hovdgrwtobenpfinrmnc_ind_5').style.opacity = 1;document.getElementById('_fb_hovdgrwtobenpfinrmnc_ind_5').style.opacity = 1;\"      onmouseout=\"document.getElementById('_tp_hovdgrwtobenpfinrmnc_ind_5').style.textDecoration = 'none';document.getElementById('_fs_hovdgrwtobenpfinrmnc_ind_5').style.opacity = 0;document.getElementById('_fb_hovdgrwtobenpfinrmnc_ind_5').style.opacity = 0;\" style=\"fill:rgb(0,0,0,0)\" /><rect x=\"68.31839730723158%\" width=\"23.34826935943509%\" y=\"40\" height=\"18\" style=\"fill:rgb(0.0, 138.56128015770724, 250.76166088685727); stroke-width:0; stroke:rgb(0,0,0)\" /><line x1=\"68.31839730723158%\" x2=\"88.90833740133178%\" y1=\"60\" y2=\"60\" id=\"_fb_hovdgrwtobenpfinrmnc_ind_1\" style=\"stroke:rgb(0.0, 138.56128015770724, 250.76166088685727);stroke-width:2; opacity: 0\"/><text x=\"78.61336735428168%\" y=\"71\" font-size=\"12px\" fill=\"rgb(0.0, 138.56128015770724, 250.76166088685727)\" id=\"_fs_hovdgrwtobenpfinrmnc_ind_1\" style=\"opacity: 0\" dominant-baseline=\"middle\" text-anchor=\"middle\">-1.274</text><svg x=\"68.31839730723158%\" y=\"40\" height=\"20\" width=\"20.5899400941002%\">  <svg x=\"0\" y=\"0\" width=\"100%\" height=\"100%\">    <text x=\"50%\" y=\"9\" font-size=\"12px\" fill=\"rgb(255,255,255)\" dominant-baseline=\"middle\" text-anchor=\"middle\">this is</text>  </svg></svg><line x1=\"88.90833740133178%\" x2=\"91.66666666666667%\" y1=\"60\" y2=\"60\" id=\"_fb_hovdgrwtobenpfinrmnc_ind_4\" style=\"stroke:rgb(0.0, 138.56128015770724, 250.76166088685727);stroke-width:2; opacity: 0\"/><text x=\"90.28750203399923%\" y=\"71\" font-size=\"12px\" fill=\"rgb(0.0, 138.56128015770724, 250.76166088685727)\" id=\"_fs_hovdgrwtobenpfinrmnc_ind_4\" style=\"opacity: 0\" dominant-baseline=\"middle\" text-anchor=\"middle\">-0.171</text><svg x=\"88.90833740133178%\" y=\"40\" height=\"20\" width=\"2.7583292653348934%\">  <svg x=\"0\" y=\"0\" width=\"100%\" height=\"100%\">    <text x=\"50%\" y=\"9\" font-size=\"12px\" fill=\"rgb(255,255,255)\" dominant-baseline=\"middle\" text-anchor=\"middle\">during summer</text>  </svg></svg><g transform=\"translate(-8,0)\">  <svg x=\"88.90833740133178%\" y=\"40\" height=\"18\" overflow=\"visible\" width=\"30\">    <path d=\"M 8 -9 l -6 18 L 8 25\" fill=\"none\" style=\"stroke:rgb(0.0, 138.56128015770724, 250.76166088685727);stroke-width:2\" />  </svg></g><g transform=\"translate(-10,0)\">  <svg x=\"88.90833740133178%\" y=\"40\" height=\"18\" overflow=\"visible\" width=\"30\">    <path d=\"M 8 -9 l -6 18 L 8 25\" fill=\"none\" style=\"stroke:rgb(0.0, 138.56128015770724, 250.76166088685727);stroke-width:2\" />  </svg></g><g transform=\"translate(-12,0)\">  <svg x=\"88.90833740133178%\" y=\"40\" height=\"18\" overflow=\"visible\" width=\"30\">    <path d=\"M 8 -9 l -6 18 L 8 25\" fill=\"none\" style=\"stroke:rgb(0.0, 138.56128015770724, 250.76166088685727);stroke-width:2\" />  </svg></g><g transform=\"translate(-14,0)\">  <svg x=\"88.90833740133178%\" y=\"40\" height=\"18\" overflow=\"visible\" width=\"30\">    <path d=\"M 8 -9 l -6 18 L 8 25\" fill=\"none\" style=\"stroke:rgb(0.0, 138.56128015770724, 250.76166088685727);stroke-width:2\" />  </svg></g><g transform=\"translate(2,0)\">  <svg x=\"88.90833740133178%\" y=\"40\" height=\"18\" overflow=\"visible\" width=\"30\">    <path d=\"M 8 -9 l -6 18 L 8 25\" fill=\"none\" style=\"stroke:rgb(0.0, 138.56128015770724, 250.76166088685727);stroke-width:2\" />  </svg></g><g transform=\"translate(0,0)\">  <svg x=\"88.90833740133178%\" y=\"40\" height=\"18\" overflow=\"visible\" width=\"30\">    <path d=\"M 8 -9 l -6 18 L 8 25\" fill=\"none\" style=\"stroke:rgb(0.0, 138.56128015770724, 250.76166088685727);stroke-width:2\" />  </svg></g><g transform=\"translate(-2,0)\">  <svg x=\"88.90833740133178%\" y=\"40\" height=\"18\" overflow=\"visible\" width=\"30\">    <path d=\"M 8 -9 l -6 18 L 8 25\" fill=\"none\" style=\"stroke:rgb(0.0, 138.56128015770724, 250.76166088685727);stroke-width:2\" />  </svg></g><g transform=\"translate(-4,0)\">  <svg x=\"88.90833740133178%\" y=\"40\" height=\"18\" overflow=\"visible\" width=\"30\">    <path d=\"M 8 -9 l -6 18 L 8 25\" fill=\"none\" style=\"stroke:rgb(0.0, 138.56128015770724, 250.76166088685727);stroke-width:2\" />  </svg></g><rect transform=\"translate(0,0)\" x=\"68.31839730723158%\" y=\"40\" width=\"8\" height=\"18\" style=\"fill:rgb(0.0, 138.56128015770724, 250.76166088685727)\"/><g transform=\"translate(-6.0,0)\">  <svg x=\"91.66666666666667%\" y=\"40\" height=\"18\" overflow=\"visible\" width=\"30\">    <path d=\"M 8 -9 l -6 18 L 8 25 L 20 25 L 20 -9\" fill=\"#ffffff\" style=\"stroke:rgb(255,255,255);stroke-width:2\" />  </svg></g><g transform=\"translate(-6.0,0)\">  <svg x=\"88.90833740133178%\" y=\"40\" height=\"18\" overflow=\"visible\" width=\"30\">    <path d=\"M 8 -9 l -6 18 L 8 25\" fill=\"none\" style=\"stroke:rgb(208, 230, 250);stroke-width:2\" />  </svg></g><rect x=\"68.31839730723158%\" y=\"40\" height=\"20\" width=\"20.5899400941002%\"      onmouseover=\"document.getElementById('_tp_hovdgrwtobenpfinrmnc_ind_1').style.textDecoration = 'underline';document.getElementById('_fs_hovdgrwtobenpfinrmnc_ind_1').style.opacity = 1;document.getElementById('_fb_hovdgrwtobenpfinrmnc_ind_1').style.opacity = 1;\"      onmouseout=\"document.getElementById('_tp_hovdgrwtobenpfinrmnc_ind_1').style.textDecoration = 'none';document.getElementById('_fs_hovdgrwtobenpfinrmnc_ind_1').style.opacity = 0;document.getElementById('_fb_hovdgrwtobenpfinrmnc_ind_1').style.opacity = 0;\" style=\"fill:rgb(0,0,0,0)\" /><rect x=\"88.90833740133178%\" y=\"40\" height=\"20\" width=\"2.7583292653348934%\"      onmouseover=\"document.getElementById('_tp_hovdgrwtobenpfinrmnc_ind_4').style.textDecoration = 'underline';document.getElementById('_fs_hovdgrwtobenpfinrmnc_ind_4').style.opacity = 1;document.getElementById('_fb_hovdgrwtobenpfinrmnc_ind_4').style.opacity = 1;\"      onmouseout=\"document.getElementById('_tp_hovdgrwtobenpfinrmnc_ind_4').style.textDecoration = 'none';document.getElementById('_fs_hovdgrwtobenpfinrmnc_ind_4').style.opacity = 0;document.getElementById('_fb_hovdgrwtobenpfinrmnc_ind_4').style.opacity = 0;\" style=\"fill:rgb(0,0,0,0)\" /></svg><div style='display: inline; text-align: center;'><div style='display: none; color: #999; padding-top: 0px; font-size: 12px;'>0.0</div><div id='_tp_hovdgrwtobenpfinrmnc_ind_0'style='display: inline; background: rgba(230.2941176470614, 26.505882352939775, 102.59215686274348, 0.0); border-radius: 3px; padding: 0px'onclick=\"if (this.previousSibling.style.display == 'none') {this.previousSibling.style.display = 'block';this.parentNode.style.display = 'inline-block';} else {this.previousSibling.style.display = 'none';this.parentNode.style.display = 'inline';}\"onmouseover=\"document.getElementById('_fb_hovdgrwtobenpfinrmnc_ind_0').style.opacity = 1; document.getElementById('_fs_hovdgrwtobenpfinrmnc_ind_0').style.opacity = 1;\"onmouseout=\"document.getElementById('_fb_hovdgrwtobenpfinrmnc_ind_0').style.opacity = 0; document.getElementById('_fs_hovdgrwtobenpfinrmnc_ind_0').style.opacity = 0;\"></div></div><div style='display: inline; text-align: center;'><div style='display: none; color: #999; padding-top: 0px; font-size: 12px;'>-1.274 / 2</div><div id='_tp_hovdgrwtobenpfinrmnc_ind_1'style='display: inline; background: rgba(30.0, 136.0, 229.0, 0.6610417904535552); border-radius: 3px; padding: 0px'onclick=\"if (this.previousSibling.style.display == 'none') {this.previousSibling.style.display = 'block';this.parentNode.style.display = 'inline-block';} else {this.previousSibling.style.display = 'none';this.parentNode.style.display = 'inline';}\"onmouseover=\"document.getElementById('_fb_hovdgrwtobenpfinrmnc_ind_1').style.opacity = 1; document.getElementById('_fs_hovdgrwtobenpfinrmnc_ind_1').style.opacity = 1;\"onmouseout=\"document.getElementById('_fb_hovdgrwtobenpfinrmnc_ind_1').style.opacity = 0; document.getElementById('_fs_hovdgrwtobenpfinrmnc_ind_1').style.opacity = 0;\">this is </div></div><div style='display: inline; text-align: center;'><div style='display: none; color: #999; padding-top: 0px; font-size: 12px;'>1.792</div><div id='_tp_hovdgrwtobenpfinrmnc_ind_2'style='display: inline; background: rgba(255.0, 13.0, 87.0, 0.9369380075262429); border-radius: 3px; padding: 0px'onclick=\"if (this.previousSibling.style.display == 'none') {this.previousSibling.style.display = 'block';this.parentNode.style.display = 'inline-block';} else {this.previousSibling.style.display = 'none';this.parentNode.style.display = 'inline';}\"onmouseover=\"document.getElementById('_fb_hovdgrwtobenpfinrmnc_ind_2').style.opacity = 1; document.getElementById('_fs_hovdgrwtobenpfinrmnc_ind_2').style.opacity = 1;\"onmouseout=\"document.getElementById('_fb_hovdgrwtobenpfinrmnc_ind_2').style.opacity = 0; document.getElementById('_fs_hovdgrwtobenpfinrmnc_ind_2').style.opacity = 0;\">co</div></div><div style='display: inline; text-align: center;'><div style='display: none; color: #999; padding-top: 0px; font-size: 12px;'>1.921</div><div id='_tp_hovdgrwtobenpfinrmnc_ind_3'style='display: inline; background: rgba(255.0, 13.0, 87.0, 1.0); border-radius: 3px; padding: 0px'onclick=\"if (this.previousSibling.style.display == 'none') {this.previousSibling.style.display = 'block';this.parentNode.style.display = 'inline-block';} else {this.previousSibling.style.display = 'none';this.parentNode.style.display = 'inline';}\"onmouseover=\"document.getElementById('_fb_hovdgrwtobenpfinrmnc_ind_3').style.opacity = 1; document.getElementById('_fs_hovdgrwtobenpfinrmnc_ind_3').style.opacity = 1;\"onmouseout=\"document.getElementById('_fb_hovdgrwtobenpfinrmnc_ind_3').style.opacity = 0; document.getElementById('_fs_hovdgrwtobenpfinrmnc_ind_3').style.opacity = 0;\">vid </div></div><div style='display: inline; text-align: center;'><div style='display: none; color: #999; padding-top: 0px; font-size: 12px;'>-0.171 / 2</div><div id='_tp_hovdgrwtobenpfinrmnc_ind_4'style='display: inline; background: rgba(30.0, 136.0, 229.0, 0.08560110913052085); border-radius: 3px; padding: 0px'onclick=\"if (this.previousSibling.style.display == 'none') {this.previousSibling.style.display = 'block';this.parentNode.style.display = 'inline-block';} else {this.previousSibling.style.display = 'none';this.parentNode.style.display = 'inline';}\"onmouseover=\"document.getElementById('_fb_hovdgrwtobenpfinrmnc_ind_4').style.opacity = 1; document.getElementById('_fs_hovdgrwtobenpfinrmnc_ind_4').style.opacity = 1;\"onmouseout=\"document.getElementById('_fb_hovdgrwtobenpfinrmnc_ind_4').style.opacity = 0; document.getElementById('_fs_hovdgrwtobenpfinrmnc_ind_4').style.opacity = 0;\">during summer</div></div><div style='display: inline; text-align: center;'><div style='display: none; color: #999; padding-top: 0px; font-size: 12px;'>0.0</div><div id='_tp_hovdgrwtobenpfinrmnc_ind_5'style='display: inline; background: rgba(230.2941176470614, 26.505882352939775, 102.59215686274348, 0.0); border-radius: 3px; padding: 0px'onclick=\"if (this.previousSibling.style.display == 'none') {this.previousSibling.style.display = 'block';this.parentNode.style.display = 'inline-block';} else {this.previousSibling.style.display = 'none';this.parentNode.style.display = 'inline';}\"onmouseover=\"document.getElementById('_fb_hovdgrwtobenpfinrmnc_ind_5').style.opacity = 1; document.getElementById('_fs_hovdgrwtobenpfinrmnc_ind_5').style.opacity = 1;\"onmouseout=\"document.getElementById('_fb_hovdgrwtobenpfinrmnc_ind_5').style.opacity = 0; document.getElementById('_fs_hovdgrwtobenpfinrmnc_ind_5').style.opacity = 0;\"></div></div>"
      ],
      "text/plain": [
       "<IPython.core.display.HTML object>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "shap.plots.text(new_shap_value[0, :, \"FAKE\"])"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.6"
  },
  "toc": {
   "base_numbering": 1,
   "nav_menu": {},
   "number_sections": true,
   "sideBar": true,
   "skip_h1_title": false,
   "title_cell": "Table of Contents",
   "title_sidebar": "Contents",
   "toc_cell": false,
   "toc_position": {},
   "toc_section_display": true,
   "toc_window_display": false
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
